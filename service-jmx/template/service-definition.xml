<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE server PUBLIC
  "-//Nimbus//DTD Nimbus 1.0//JA"
  "http://nimbus.sourceforge.jp/dtd/nimbus-service_1_0.dtd">

<server>

    <manager name="Template.Service.JMX">

        <!-- JMXサーバとの接続を生成するMBeanServerConnectionFactoryサービス -->
        <service name="MBeanServerConnectionFactory"
                 code="jp.ossc.nimbus.service.jmx.DefaultMBeanServerConnectionFactoryService"
                 instance="template">

            <service-property name="Template.Service.JMX.MBeanServerConnectionFactory.JNDI_FINDER_SERVICE_NAME">#JndiFinder</service-property>

<ifdef name="Template.Service.JMX.MBeanServerConnectionFactory.JNDI_FINDER_SERVICE_NAME">
            <!-- MBeanServerConnectionをJNDIからlookupする場合に使用するJndiFinderサービスのサービス名を設定する -->
            <attribute name="JndiFinderServiceName">${Template.Service.JMX.MBeanServerConnectionFactory.JNDI_FINDER_SERVICE_NAME}</attribute>
            <depends>${Template.Service.JMX.MBeanServerConnectionFactory.JNDI_FINDER_SERVICE_NAME}</depends>
</ifdef>
        </service>

        <manager-property name="Template.Service.JMX.MBeanWatcher.CHECK_INTERVAL">1000</manager-property>
        <manager-property name="Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT">yyyy/MM/dd HH:mm:ss</manager-property>
        <manager-property name="Template.Service.JMX.MBeanWatcher.MBEAN_SERVER_CON_FAC_SERVICE_NAME">#MBeanServerConnectionFactory</manager-property>

        <!-- MBeanを監視するサービス -->
        <service name="MBeanWatcher"
                 code="jp.ossc.nimbus.service.jmx.MBeanWatcherService"
                 instance="template">

            <service-property name="Template.Service.JMX.MBeanWatcher.CHECK_INTERVAL">1000</service-property>
            <service-property name="Template.Service.JMX.MBeanWatcher.MBEAN_SERVER_CON_FAC_SERVICE_NAME">#MBeanServerConnectionFactory</service-property>
            <service-property name="Template.Service.JMX.MBeanWatcher.CATEGORY_SERVICE_NAME">#Category</service-property>

            <!-- サービス開始時にJMXサーバへ接続するかどうかを設定する -->
            <attribute name="ConnectOnStart">false</attribute>

            <!-- 監視間隔[ms]を設定する -->
<ifdef name="Template.Service.JMX.MBeanWatcher.CHECK_INTERVAL">
            <attribute name="Interval">${Template.Service.JMX.MBeanWatcher.CHECK_INTERVAL}</attribute>
</ifdef>

            <!-- JMXサーバへの接続に使用するMBeanServerConnectionFactoryサービスのサービス名を設定する -->
<ifdef name="Template.Service.JMX.MBeanWatcher.MBEAN_SERVER_CON_FAC_SERVICE_NAME">
            <attribute name="MBeanServerConnectionFactoryServiceName">${Template.Service.JMX.MBeanWatcher.MBEAN_SERVER_CON_FAC_SERVICE_NAME}</attribute>
            <depends>${Template.Service.JMX.MBeanWatcher.MBEAN_SERVER_CON_FAC_SERVICE_NAME}</depends>
</ifdef>

            <!-- Categoryサービスのサービス名を設定する -->
<ifdef name="Template.Service.JMX.MBeanWatcher.CATEGORY_SERVICE_NAME">
            <attribute name="CategoryServiceName">${Template.Service.JMX.MBeanWatcher.CATEGORY_SERVICE_NAME}</attribute>
            <depends>${Template.Service.JMX.MBeanWatcher.CATEGORY_SERVICE_NAME}</depends>
</ifdef>
        </service>

    </manager>

    <manager name="Template.Service.JMX.MBeanWatcher.Queue">

        <!-- jp.ossc.nimbus.service.queue.DefaultQueueServiceMBeanを監視するサービス -->
        <service name="QueueWatcher"
                 template="Template.Service.JMX#MBeanWatcher"
                 instance="template">

            <service-property name="Template.Service.JMX.MBeanWatcher.Queue.MAX_DEPTH_PERIOD_COUNT">60</service-property>
            
            <attribute name="Description">Queueの監視</attribute>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Timestamp">
                        <attribute name="Description">タイムスタンプ</attribute>
<ifdef name="Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT">
                        <attribute name="Format">${Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT}</attribute>
</ifdef>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attributes">
                        <attribute name="ContextKey">Attributes</attribute>
                        <attribute name="Names">
                            Count,
                            Depth,
                            MaxDepth
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">流入量</attribute>
                        <attribute name="Key">Count</attribute>
                        <attribute name="ContextKey">Attributes.Count</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">流入量の差分</attribute>
                        <attribute name="Key">CountDelta</attribute>
                        <attribute name="ContextKey">CountDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes.Count</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">滞留量</attribute>
                        <attribute name="Key">Depth</attribute>
                        <attribute name="ContextKey">Attributes.Depth</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">滞留量の差分</attribute>
                        <attribute name="Key">DepthDelta</attribute>
                        <attribute name="ContextKey">DepthDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes.Depth</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
<ifdef name="Template.Service.JMX.MBeanWatcher.Queue.MAX_DEPTH_PERIOD_COUNT">
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Max">
                        <attribute name="Description">期間内の最大滞留量</attribute>
                        <attribute name="Key">MaxDepth</attribute>
                        <attribute name="ContextKey">MaxDepth</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Period">
                                <attribute name="Interval">${Template.Service.JMX.MBeanWatcher.CHECK_INTERVAL}</attribute>
                                <attribute name="Count">${Template.Service.JMX.MBeanWatcher.Queue.MAX_DEPTH_PERIOD_COUNT}</attribute>
                                <attribute name="Target">
                                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                        <attribute name="ContextKey">Attributes.Depth</attribute>
                                    </object>
                                </attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
</ifdef>
<ifdef name="Template.Service.JMX.MBeanWatcher.Queue.MAX_DEPTH_PERIOD_COUNT" not="true">
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">過去の最大滞留量</attribute>
                        <attribute name="Key">MaxDepth</attribute>
                        <attribute name="ContextKey">Attributes.MaxDepth</attribute>
                    </object>
                </argument>
            </invoke>
</ifdef>
        </service>

        <!-- jp.ossc.nimbus.service.queue.DefaultQueueServiceMBeanの集合を監視するサービス -->
        <service name="QueuesWatcher"
                 template="Template.Service.JMX#MBeanWatcher"
                 instance="template">

            <service-property name="Template.Service.JMX.MBeanWatcher.Queue.MAX_DEPTH_PERIOD_COUNT">60</service-property>

            <attribute name="Description">複数のQueueの監視</attribute>
            
            <attribute name="MBeanSet">true</attribute>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Timestamp">
                        <attribute name="Description">タイムスタンプ</attribute>
<ifdef name="Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT">
                        <attribute name="Format">${Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT}</attribute>
</ifdef>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attributes">
                        <attribute name="ContextKey">Attributes</attribute>
                        <attribute name="Names">
                            Count,
                            Depth,
                            MaxDepth
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Sum">
                        <attribute name="Description">流入量</attribute>
                        <attribute name="Key">Count</attribute>
                        <attribute name="ContextKey">Count</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                                <attribute name="Property">Count</attribute>
                                <attribute name="ElementEdit">true</attribute>
                                <attribute name="Target">
                                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                        <attribute name="ContextKey">Attributes</attribute>
                                    </object>
                                </attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">流入量の差分</attribute>
                        <attribute name="Key">CountDelta</attribute>
                        <attribute name="ContextKey">CountDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Count</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Sum">
                        <attribute name="Description">滞留量</attribute>
                        <attribute name="Key">Depth</attribute>
                        <attribute name="ContextKey">Depth</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                                <attribute name="Property">Depth</attribute>
                                <attribute name="ElementEdit">true</attribute>
                                <attribute name="Target">
                                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                        <attribute name="ContextKey">Attributes</attribute>
                                    </object>
                                </attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">滞留量の差分</attribute>
                        <attribute name="Key">DepthDelta</attribute>
                        <attribute name="ContextKey">DepthDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Depth</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
<ifdef name="Template.Service.JMX.MBeanWatcher.Queue.MAX_DEPTH_PERIOD_COUNT">
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Max">
                        <attribute name="Description">期間内の最大滞留量</attribute>
                        <attribute name="Key">MaxDepth</attribute>
                        <attribute name="ContextKey">MaxDepth</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Period">
                                <attribute name="Interval">${Template.Service.JMX.MBeanWatcher.CHECK_INTERVAL}</attribute>
                                <attribute name="Count">${Template.Service.JMX.MBeanWatcher.Queue.MAX_DEPTH_PERIOD_COUNT}</attribute>
                                <attribute name="Target">
                                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                        <attribute name="ContextKey">Depth</attribute>
                                    </object>
                                </attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
</ifdef>
<ifdef name="Template.Service.JMX.MBeanWatcher.Queue.MAX_DEPTH_PERIOD_COUNT" not="true">
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Sum">
                        <attribute name="Description">過去の最大滞留量</attribute>
                        <attribute name="Key">MaxDepth</attribute>
                        <attribute name="ContextKey">MaxDepth</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                                <attribute name="Property">MaxDepth</attribute>
                                <attribute name="ElementEdit">true</attribute>
                                <attribute name="Target">
                                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                        <attribute name="ContextKey">Attributes</attribute>
                                    </object>
                                </attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
</ifdef>
        </service>

        <service name="QueueWritableRecordFactory"
                 template="Template.Service.Writer.WritableRecordFactory#PropertyWritableRecordFactory"
                 instance="template">
            <attribute name="Format">%Timestamp%,%Count%,%CountDelta%,%Depth%,%DepthDelta%,%MaxDepth%</attribute>
        </service>

        <!-- jp.ossc.nimbus.service.queue.QueueHandlerContainerServiceMBeanを監視するサービス -->
        <service name="QueueHandlerContainerWatcher"
                 template="Template.Service.JMX#MBeanWatcher"
                 instance="template">

            <service-property name="Template.Service.JMX.MBeanWatcher.QueueHandlerContainer.MAX_ACTIVE_QUEUE_HANDLER_SIZE">60</service-property>
            
            <attribute name="Description">QueueHandlerContainerの監視</attribute>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Timestamp">
                        <attribute name="Description">タイムスタンプ</attribute>
<ifdef name="Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT">
                        <attribute name="Format">${Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT}</attribute>
</ifdef>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attributes">
                        <attribute name="ContextKey">Attributes</attribute>
                        <attribute name="Names">
                            QueueHandlerSize,
                            ActiveQueueHandlerSize,
                            StandbyQueueHandlerSize
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">ハンドラの数</attribute>
                        <attribute name="Key">QueueHandlerSize</attribute>
                        <attribute name="ContextKey">Attributes.QueueHandlerSize</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">処理中のハンドラの数</attribute>
                        <attribute name="Key">ActiveQueueHandlerSize</attribute>
                        <attribute name="ContextKey">Attributes.ActiveQueueHandlerSize</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Max">
                        <attribute name="Description">期間内の処理中のハンドラの最大数</attribute>
                        <attribute name="Key">MaxActiveQueueHandlerSize</attribute>
                        <attribute name="ContextKey">MaxActiveQueueHandlerSize</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Period">
                                <attribute name="Interval">${Template.Service.JMX.MBeanWatcher.CHECK_INTERVAL}</attribute>
                                <attribute name="Count">${Template.Service.JMX.MBeanWatcher.QueueHandlerContainer.MAX_ACTIVE_QUEUE_HANDLER_SIZE}</attribute>
                                <attribute name="Target">
                                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                        <attribute name="ContextKey">Attributes.ActiveQueueHandlerSize</attribute>
                                    </object>
                                </attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">待機中のハンドラの数</attribute>
                        <attribute name="Key">StandbyQueueHandlerSize</attribute>
                        <attribute name="ContextKey">Attributes.StandbyQueueHandlerSize</attribute>
                    </object>
                </argument>
            </invoke>
        </service>

        <service name="QueueHandlerContainerWritableRecordFactory"
                 template="Template.Service.Writer.WritableRecordFactory#PropertyWritableRecordFactory"
                 instance="template">
            <attribute name="Format">%Timestamp%,%ActiveQueueHandlerSize%,%MaxActiveQueueHandlerSize%,%StandbyQueueHandlerSize%</attribute>
        </service>

    </manager>

    <manager name="Template.Service.JMX.MBeanWatcher.Java">

        <!-- Java6、7のCMS GCに設定されたJavaVMのヒープを監視するサービス -->
        <service name="CMSHeapWatcher"
                 template="Template.Service.JMX#MBeanWatcher"
                 instance="template">
            
            <attribute name="Description">CMS GCに設定されたJavaVMのヒープの監視</attribute>
            
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Timestamp">
                        <attribute name="Description">タイムスタンプ</attribute>
<ifdef name="Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT">
                        <attribute name="Format">${Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT}</attribute>
</ifdef>
                    </object>
                </argument>
            </invoke>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="ObjectName">java.lang:type=MemoryPool,name=Code Cache</attribute>
                        <attribute name="ContextKey">CodeCacheUsage</attribute>
                        <attribute name="Name">Usage</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">CodeCache領域の使用量</attribute>
                        <attribute name="Key">CodeCacheUsed</attribute>
                        <attribute name="ContextKey">CodeCacheUsed</attribute>
                        <attribute name="Property">(used)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">CodeCacheUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">CodeCache領域の最大量</attribute>
                        <attribute name="Key">CodeCacheMax</attribute>
                        <attribute name="ContextKey">CodeCacheMax</attribute>
                        <attribute name="Property">(max)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">CodeCacheUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$PercentageOperation">
                        <attribute name="Description">CodeCache領域の使用率[%]</attribute>
                        <attribute name="Key">CodeCacheUsedRate</attribute>
                        <attribute name="ContextKey">CodeCacheUsedRate</attribute>
                        <attribute name="Scale">2</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="ReturnZeroOnZeroDivide">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">CodeCacheUsed</attribute>
                            </object>
                        </attribute>
                        <attribute name="SecondTarget">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">CodeCacheMax</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="ObjectName">java.lang:type=MemoryPool,name=CMS Perm Gen</attribute>
                        <attribute name="ContextKey">PermUsage</attribute>
                        <attribute name="Name">Usage</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">Permanent領域の使用量</attribute>
                        <attribute name="Key">PermUsed</attribute>
                        <attribute name="ContextKey">PermUsed</attribute>
                        <attribute name="Property">(used)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">PermUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">Permanent領域の最大量</attribute>
                        <attribute name="Key">PermMax</attribute>
                        <attribute name="ContextKey">PermMax</attribute>
                        <attribute name="Property">(max)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">PermUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$PercentageOperation">
                        <attribute name="Description">Permanent領域の使用率[%]</attribute>
                        <attribute name="Key">PermUsedRate</attribute>
                        <attribute name="ContextKey">PermUsedRate</attribute>
                        <attribute name="Scale">2</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="ReturnZeroOnZeroDivide">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">PermUsed</attribute>
                            </object>
                        </attribute>
                        <attribute name="SecondTarget">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">PermMax</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="ObjectName">java.lang:type=MemoryPool,name=Par Eden Space</attribute>
                        <attribute name="ContextKey">EdenUsage</attribute>
                        <attribute name="Name">Usage</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">Eden領域の使用量</attribute>
                        <attribute name="Key">EdenUsed</attribute>
                        <attribute name="ContextKey">EdenUsed</attribute>
                        <attribute name="Property">(used)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">EdenUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">Eden領域の最大量</attribute>
                        <attribute name="Key">EdenMax</attribute>
                        <attribute name="ContextKey">EdenMax</attribute>
                        <attribute name="Property">(max)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">EdenUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$PercentageOperation">
                        <attribute name="Description">Eden領域の使用率[%]</attribute>
                        <attribute name="Key">EdenUsedRate</attribute>
                        <attribute name="ContextKey">EdenUsedRate</attribute>
                        <attribute name="Scale">2</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="ReturnZeroOnZeroDivide">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">EdenUsed</attribute>
                            </object>
                        </attribute>
                        <attribute name="SecondTarget">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">EdenMax</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="ObjectName">java.lang:type=MemoryPool,name=Par Survivor Space</attribute>
                        <attribute name="ContextKey">SurvivorUsage</attribute>
                        <attribute name="Name">Usage</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">Survivor領域の使用量</attribute>
                        <attribute name="Key">SurvivorUsed</attribute>
                        <attribute name="ContextKey">SurvivorUsed</attribute>
                        <attribute name="Property">(used)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">SurvivorUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">Survivor領域の最大量</attribute>
                        <attribute name="Key">SurvivorMax</attribute>
                        <attribute name="ContextKey">SurvivorMax</attribute>
                        <attribute name="Property">(max)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">SurvivorUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$PercentageOperation">
                        <attribute name="Description">Survivor領域の使用率[%]</attribute>
                        <attribute name="Key">SurvivorUsedRate</attribute>
                        <attribute name="ContextKey">SurvivorUsedRate</attribute>
                        <attribute name="Scale">2</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="ReturnZeroOnZeroDivide">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">SurvivorUsed</attribute>
                            </object>
                        </attribute>
                        <attribute name="SecondTarget">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">SurvivorMax</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="ObjectName">java.lang:type=MemoryPool,name=CMS Old Gen</attribute>
                        <attribute name="ContextKey">OldUsage</attribute>
                        <attribute name="Name">Usage</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">Old領域の使用量</attribute>
                        <attribute name="Key">OldUsed</attribute>
                        <attribute name="ContextKey">OldUsed</attribute>
                        <attribute name="Property">(used)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">OldUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">Old領域の最大量</attribute>
                        <attribute name="Key">OldMax</attribute>
                        <attribute name="ContextKey">OldMax</attribute>
                        <attribute name="Property">(max)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">OldUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$PercentageOperation">
                        <attribute name="Description">Old領域の使用率[%]</attribute>
                        <attribute name="Key">OldUsedRate</attribute>
                        <attribute name="ContextKey">OldUsedRate</attribute>
                        <attribute name="Scale">2</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="ReturnZeroOnZeroDivide">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">OldUsed</attribute>
                            </object>
                        </attribute>
                        <attribute name="SecondTarget">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">OldMax</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="Description">YoungGCの回数</attribute>
                        <attribute name="ObjectName">java.lang:type=GarbageCollector,name=ParNew</attribute>
                        <attribute name="ContextKey">YoungGCCount</attribute>
                        <attribute name="Key">YoungGCCount</attribute>
                        <attribute name="Name">CollectionCount</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">YoungGCの回数の差分</attribute>
                        <attribute name="Key">YoungGCCountDelta</attribute>
                        <attribute name="ContextKey">YoungGCCountDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">YoungGCCount</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="Description">YoungGCの時間</attribute>
                        <attribute name="ObjectName">java.lang:type=GarbageCollector,name=ParNew</attribute>
                        <attribute name="ContextKey">YoungGCTime</attribute>
                        <attribute name="Key">YoungGCTime</attribute>
                        <attribute name="Name">CollectionTime</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">YoungGCの時間の差分</attribute>
                        <attribute name="Key">YoungGCTimeDelta</attribute>
                        <attribute name="ContextKey">YoungGCTimeDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">YoungGCTime</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="Description">FullGCの回数</attribute>
                        <attribute name="ObjectName">java.lang:type=GarbageCollector,name=ConcurrentMarkSweep</attribute>
                        <attribute name="ContextKey">FullGCCount</attribute>
                        <attribute name="Key">FullGCCount</attribute>
                        <attribute name="Name">CollectionCount</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">FullGCの回数の差分</attribute>
                        <attribute name="Key">FullGCCountDelta</attribute>
                        <attribute name="ContextKey">FullGCCountDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">FullGCCount</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="Description">FullGCの時間</attribute>
                        <attribute name="ObjectName">java.lang:type=GarbageCollector,name=ConcurrentMarkSweep</attribute>
                        <attribute name="ContextKey">FullGCTime</attribute>
                        <attribute name="Key">FullGCTime</attribute>
                        <attribute name="Name">CollectionTime</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">FullGCの時間の差分</attribute>
                        <attribute name="Key">FullGCTimeDelta</attribute>
                        <attribute name="ContextKey">FullGCTimeDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">FullGCTime</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
        </service>

        <service name="CMSHeapWritableRecordFactory"
                 template="Template.Service.Writer.WritableRecordFactory#PropertyWritableRecordFactory"
                 instance="template">
            <attribute name="Format">%Timestamp%,%CodeCacheUsed%,%CodeCacheMax%,%CodeCacheUsedRate%,%PermUsed%,%PermMax%,%PermUsedRate%,%EdenUsed%,%EdenMax%,%EdenUsedRate%,%SurvivorUsed%,%SurvivorMax%,%SurvivorUsedRate%,%OldUsed%,%OldMax%,%OldUsedRate%,%YoungGCCount%,%YoungGCCountDelta%,%YoungGCTime%,%YoungGCTimeDelta%,%FullGCCount%,%FullGCCountDelta%,%FullGCTime%,%FullGCTimeDelta%</attribute>
        </service>

        <!-- Java8のCMS GCに設定されたJavaVMのヒープを監視するサービス -->
        <service name="Java8CMSHeapWatcher"
                 template="Template.Service.JMX#MBeanWatcher"
                 instance="template">
            
            <attribute name="Description">CMS GCに設定されたJavaVMのヒープの監視（Java8以降）</attribute>
            
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Timestamp">
                        <attribute name="Description">タイムスタンプ</attribute>
<ifdef name="Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT">
                        <attribute name="Format">${Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT}</attribute>
</ifdef>
                    </object>
                </argument>
            </invoke>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="ObjectName">java.lang:type=MemoryPool,name=Code Cache</attribute>
                        <attribute name="ContextKey">CodeCacheUsage</attribute>
                        <attribute name="Name">Usage</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">CodeCache領域の使用量</attribute>
                        <attribute name="Key">CodeCacheUsed</attribute>
                        <attribute name="ContextKey">CodeCacheUsed</attribute>
                        <attribute name="Property">(used)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">CodeCacheUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">CodeCache領域の最大量</attribute>
                        <attribute name="Key">CodeCacheMax</attribute>
                        <attribute name="ContextKey">CodeCacheMax</attribute>
                        <attribute name="Property">(max)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">CodeCacheUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$PercentageOperation">
                        <attribute name="Description">CodeCache領域の使用率[%]</attribute>
                        <attribute name="Key">CodeCacheUsedRate</attribute>
                        <attribute name="ContextKey">CodeCacheUsedRate</attribute>
                        <attribute name="Scale">2</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="ReturnZeroOnZeroDivide">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">CodeCacheUsed</attribute>
                            </object>
                        </attribute>
                        <attribute name="SecondTarget">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">CodeCacheMax</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="ObjectName">java.lang:type=MemoryPool,name=Compressed Class Space</attribute>
                        <attribute name="ContextKey">CompressedClassUsage</attribute>
                        <attribute name="Name">Usage</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">CompressedClass領域の使用量</attribute>
                        <attribute name="Key">CompressedClassUsed</attribute>
                        <attribute name="ContextKey">CompressedClassUsed</attribute>
                        <attribute name="Property">(used)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">CompressedClassUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">CompressedClass領域の最大量</attribute>
                        <attribute name="Key">CompressedClassMax</attribute>
                        <attribute name="ContextKey">CompressedClassMax</attribute>
                        <attribute name="Property">(max)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">CompressedClassUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$PercentageOperation">
                        <attribute name="Description">CompressedClass領域の使用率[%]</attribute>
                        <attribute name="Key">CompressedClassUsedRate</attribute>
                        <attribute name="ContextKey">CompressedClassUsedRate</attribute>
                        <attribute name="Scale">2</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="ReturnZeroOnZeroDivide">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">CompressedClassUsed</attribute>
                            </object>
                        </attribute>
                        <attribute name="SecondTarget">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">CompressedClassMax</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="ObjectName">java.lang:type=MemoryPool,name=Metaspace</attribute>
                        <attribute name="ContextKey">MetaspaceUsage</attribute>
                        <attribute name="Name">Usage</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">Metaspace領域の使用量</attribute>
                        <attribute name="Key">MetaspaceUsed</attribute>
                        <attribute name="ContextKey">MetaspaceUsed</attribute>
                        <attribute name="Property">(used)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">MetaspaceUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">Metaspace領域の最大量</attribute>
                        <attribute name="Key">MetaspaceMax</attribute>
                        <attribute name="ContextKey">MetaspaceMax</attribute>
                        <attribute name="Property">(max)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">MetaspaceUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$PercentageOperation">
                        <attribute name="Description">Metaspace領域の使用率[%]</attribute>
                        <attribute name="Key">MetaspaceUsedRate</attribute>
                        <attribute name="ContextKey">MetaspaceUsedRate</attribute>
                        <attribute name="Scale">2</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="ReturnZeroOnZeroDivide">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">MetaspaceUsed</attribute>
                            </object>
                        </attribute>
                        <attribute name="SecondTarget">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">MetaspaceMax</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="ObjectName">java.lang:type=MemoryPool,name=Par Eden Space</attribute>
                        <attribute name="ContextKey">EdenUsage</attribute>
                        <attribute name="Name">Usage</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">Eden領域の使用量</attribute>
                        <attribute name="Key">EdenUsed</attribute>
                        <attribute name="ContextKey">EdenUsed</attribute>
                        <attribute name="Property">(used)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">EdenUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">Eden領域の最大量</attribute>
                        <attribute name="Key">EdenMax</attribute>
                        <attribute name="ContextKey">EdenMax</attribute>
                        <attribute name="Property">(max)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">EdenUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$PercentageOperation">
                        <attribute name="Description">Eden領域の使用率[%]</attribute>
                        <attribute name="Key">EdenUsedRate</attribute>
                        <attribute name="ContextKey">EdenUsedRate</attribute>
                        <attribute name="Scale">2</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="ReturnZeroOnZeroDivide">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">EdenUsed</attribute>
                            </object>
                        </attribute>
                        <attribute name="SecondTarget">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">EdenMax</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="ObjectName">java.lang:type=MemoryPool,name=Par Survivor Space</attribute>
                        <attribute name="ContextKey">SurvivorUsage</attribute>
                        <attribute name="Name">Usage</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">Survivor領域の使用量</attribute>
                        <attribute name="Key">SurvivorUsed</attribute>
                        <attribute name="ContextKey">SurvivorUsed</attribute>
                        <attribute name="Property">(used)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">SurvivorUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">Survivor領域の最大量</attribute>
                        <attribute name="Key">SurvivorMax</attribute>
                        <attribute name="ContextKey">SurvivorMax</attribute>
                        <attribute name="Property">(max)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">SurvivorUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$PercentageOperation">
                        <attribute name="Description">Survivor領域の使用率[%]</attribute>
                        <attribute name="Key">SurvivorUsedRate</attribute>
                        <attribute name="ContextKey">SurvivorUsedRate</attribute>
                        <attribute name="Scale">2</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="ReturnZeroOnZeroDivide">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">SurvivorUsed</attribute>
                            </object>
                        </attribute>
                        <attribute name="SecondTarget">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">SurvivorMax</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="ObjectName">java.lang:type=MemoryPool,name=CMS Old Gen</attribute>
                        <attribute name="ContextKey">OldUsage</attribute>
                        <attribute name="Name">Usage</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">Old領域の使用量</attribute>
                        <attribute name="Key">OldUsed</attribute>
                        <attribute name="ContextKey">OldUsed</attribute>
                        <attribute name="Property">(used)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">OldUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">Old領域の最大量</attribute>
                        <attribute name="Key">OldMax</attribute>
                        <attribute name="ContextKey">OldMax</attribute>
                        <attribute name="Property">(max)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">OldUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$PercentageOperation">
                        <attribute name="Description">Old領域の使用率[%]</attribute>
                        <attribute name="Key">OldUsedRate</attribute>
                        <attribute name="ContextKey">OldUsedRate</attribute>
                        <attribute name="Scale">2</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="ReturnZeroOnZeroDivide">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">OldUsed</attribute>
                            </object>
                        </attribute>
                        <attribute name="SecondTarget">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">OldMax</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="Description">YoungGCの回数</attribute>
                        <attribute name="ObjectName">java.lang:type=GarbageCollector,name=ParNew</attribute>
                        <attribute name="ContextKey">YoungGCCount</attribute>
                        <attribute name="Key">YoungGCCount</attribute>
                        <attribute name="Name">CollectionCount</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">YoungGCの回数の差分</attribute>
                        <attribute name="Key">YoungGCCountDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">YoungGCCount</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="Description">YoungGCの時間</attribute>
                        <attribute name="ObjectName">java.lang:type=GarbageCollector,name=ParNew</attribute>
                        <attribute name="ContextKey">YoungGCTime</attribute>
                        <attribute name="Key">YoungGCTime</attribute>
                        <attribute name="Name">CollectionTime</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">YoungGCの時間の差分</attribute>
                        <attribute name="Key">YoungGCTimeDelta</attribute>
                        <attribute name="ContextKey">YoungGCTimeDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">YoungGCTime</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="Description">FullGCの回数</attribute>
                        <attribute name="ObjectName">java.lang:type=GarbageCollector,name=ConcurrentMarkSweep</attribute>
                        <attribute name="ContextKey">FullGCCount</attribute>
                        <attribute name="Key">FullGCCount</attribute>
                        <attribute name="Name">CollectionCount</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">FullGCの回数の差分</attribute>
                        <attribute name="Key">FullGCCountDelta</attribute>
                        <attribute name="ContextKey">FullGCCountDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">FullGCCount</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="Description">FullGCの時間</attribute>
                        <attribute name="ObjectName">java.lang:type=GarbageCollector,name=ConcurrentMarkSweep</attribute>
                        <attribute name="ContextKey">FullGCTime</attribute>
                        <attribute name="Key">FullGCTime</attribute>
                        <attribute name="Name">CollectionTime</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">FullGCの時間の差分</attribute>
                        <attribute name="Key">FullGCTimeDelta</attribute>
                        <attribute name="ContextKey">FullGCTimeDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">FullGCTime</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
        </service>

        <service name="Java8CMSHeapWritableRecordFactory"
                 template="Template.Service.Writer.WritableRecordFactory#PropertyWritableRecordFactory"
                 instance="template">
            <attribute name="Format">%Timestamp%,%CodeCacheUsed%,%CodeCacheMax%,%CodeCacheUsedRate%,%CompressedClassUsed%,%CompressedClassMax%,%CompressedClassUsedRate%,%MetaspaceUsed%,%MetaspaceMax%,%MetaspaceUsedRate%,%EdenUsed%,%EdenMax%,%EdenUsedRate%,%SurvivorUsed%,%SurvivorMax%,%SurvivorUsedRate%,%OldUsed%,%OldMax%,%OldUsedRate%,%YoungGCCount%,%YoungGCCountDelta%,%YoungGCTime%,%YoungGCTimeDelta%,%FullGCCount%,%FullGCCountDelta%,%FullGCTime%,%FullGCTimeDelta%</attribute>
        </service>

        <!-- Java8のG1 GCに設定されたJavaVMのヒープを監視するサービス -->
        <service name="Java8G1HeapWatcher"
                 template="Template.Service.JMX#MBeanWatcher"
                 instance="template">

            <service-property name="Template.Service.JMX.MBeanWatcher.Java.COMPRESSED_CLASS_SPACE">true</service-property>
            
            <attribute name="Description">G1GCに設定されたJavaVMのヒープの監視</attribute>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Timestamp">
                        <attribute name="Description">タイムスタンプ</attribute>
<ifdef name="Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT">
                        <attribute name="Format">${Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT}</attribute>
</ifdef>
                    </object>
                </argument>
            </invoke>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="ObjectName">java.lang:type=MemoryPool,name=Code Cache</attribute>
                        <attribute name="ContextKey">CodeCacheUsage</attribute>
                        <attribute name="Name">Usage</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">CodeCache領域の使用量</attribute>
                        <attribute name="Key">CodeCacheUsed</attribute>
                        <attribute name="ContextKey">CodeCacheUsed</attribute>
                        <attribute name="Property">(used)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">CodeCacheUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">CodeCache領域の最大量</attribute>
                        <attribute name="Key">CodeCacheMax</attribute>
                        <attribute name="ContextKey">CodeCacheMax</attribute>
                        <attribute name="Property">(max)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">CodeCacheUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$PercentageOperation">
                        <attribute name="Description">CodeCache領域の使用率[%]</attribute>
                        <attribute name="Key">CodeCacheUsedRate</attribute>
                        <attribute name="ContextKey">CodeCacheUsedRate</attribute>
                        <attribute name="Scale">2</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="ReturnZeroOnZeroDivide">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">CodeCacheUsed</attribute>
                            </object>
                        </attribute>
                        <attribute name="SecondTarget">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">CodeCacheMax</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>

<ifdef name="Template.Service.JMX.MBeanWatcher.Java.COMPRESSED_CLASS_SPACE" value="true">
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="ObjectName">java.lang:type=MemoryPool,name=Compressed Class Space</attribute>
                        <attribute name="ContextKey">CompressedClassUsage</attribute>
                        <attribute name="Name">Usage</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">CompressedClass領域の使用量</attribute>
                        <attribute name="Key">CompressedClassUsed</attribute>
                        <attribute name="ContextKey">CompressedClassUsed</attribute>
                        <attribute name="Property">(used)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">CompressedClassUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">CompressedClass領域の最大量</attribute>
                        <attribute name="Key">CompressedClassMax</attribute>
                        <attribute name="ContextKey">CompressedClassMax</attribute>
                        <attribute name="Property">(max)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">CompressedClassUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$PercentageOperation">
                        <attribute name="Description">CompressedClass領域の使用率[%]</attribute>
                        <attribute name="Key">CompressedClassUsedRate</attribute>
                        <attribute name="ContextKey">CompressedClassUsedRate</attribute>
                        <attribute name="Scale">2</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="ReturnZeroOnZeroDivide">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">CompressedClassUsed</attribute>
                            </object>
                        </attribute>
                        <attribute name="SecondTarget">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">CompressedClassMax</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
</ifdef>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="ObjectName">java.lang:type=MemoryPool,name=Metaspace</attribute>
                        <attribute name="ContextKey">MetaspaceUsage</attribute>
                        <attribute name="Name">Usage</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">Metaspace領域の使用量</attribute>
                        <attribute name="Key">MetaspaceUsed</attribute>
                        <attribute name="ContextKey">MetaspaceUsed</attribute>
                        <attribute name="Property">(used)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">MetaspaceUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">Metaspace領域の最大量</attribute>
                        <attribute name="Key">MetaspaceMax</attribute>
                        <attribute name="ContextKey">MetaspaceMax</attribute>
                        <attribute name="Property">(max)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">MetaspaceUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$PercentageOperation">
                        <attribute name="Description">Metaspace領域の使用率[%]</attribute>
                        <attribute name="Key">MetaspaceUsedRate</attribute>
                        <attribute name="ContextKey">MetaspaceUsedRate</attribute>
                        <attribute name="Scale">2</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="ReturnZeroOnZeroDivide">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">MetaspaceUsed</attribute>
                            </object>
                        </attribute>
                        <attribute name="SecondTarget">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">MetaspaceMax</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="ObjectName">java.lang:type=MemoryPool,name=G1 Eden Space</attribute>
                        <attribute name="ContextKey">EdenUsage</attribute>
                        <attribute name="Name">Usage</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">Eden領域の使用量</attribute>
                        <attribute name="Key">EdenUsed</attribute>
                        <attribute name="ContextKey">EdenUsed</attribute>
                        <attribute name="Property">(used)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">EdenUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">Eden領域の最大量</attribute>
                        <attribute name="Key">EdenCommitted</attribute>
                        <attribute name="ContextKey">EdenCommitted</attribute>
                        <attribute name="Property">(committed)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">EdenUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$PercentageOperation">
                        <attribute name="Description">Eden領域の使用率[%]</attribute>
                        <attribute name="Key">EdenUsedRate</attribute>
                        <attribute name="ContextKey">EdenUsedRate</attribute>
                        <attribute name="Scale">2</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="ReturnZeroOnZeroDivide">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">EdenUsed</attribute>
                            </object>
                        </attribute>
                        <attribute name="SecondTarget">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">EdenCommitted</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="ObjectName">java.lang:type=MemoryPool,name=G1 Survivor Space</attribute>
                        <attribute name="ContextKey">SurvivorUsage</attribute>
                        <attribute name="Name">Usage</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">Survivor領域の使用量</attribute>
                        <attribute name="Key">SurvivorUsed</attribute>
                        <attribute name="ContextKey">SurvivorUsed</attribute>
                        <attribute name="Property">(used)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">SurvivorUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">Survivor領域の最大量</attribute>
                        <attribute name="Key">SurvivorCommitted</attribute>
                        <attribute name="ContextKey">SurvivorCommitted</attribute>
                        <attribute name="Property">(committed)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">SurvivorUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$PercentageOperation">
                        <attribute name="Description">Survivor領域の使用率[%]</attribute>
                        <attribute name="Key">SurvivorUsedRate</attribute>
                        <attribute name="ContextKey">SurvivorUsedRate</attribute>
                        <attribute name="Scale">2</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="ReturnZeroOnZeroDivide">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">SurvivorUsed</attribute>
                            </object>
                        </attribute>
                        <attribute name="SecondTarget">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">SurvivorCommitted</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="ObjectName">java.lang:type=MemoryPool,name=G1 Old Gen</attribute>
                        <attribute name="ContextKey">OldUsage</attribute>
                        <attribute name="Name">Usage</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">Old領域の使用量</attribute>
                        <attribute name="Key">OldUsed</attribute>
                        <attribute name="ContextKey">OldUsed</attribute>
                        <attribute name="Property">(used)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">OldUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">Old領域の最大量</attribute>
                        <attribute name="Key">OldMax</attribute>
                        <attribute name="ContextKey">OldMax</attribute>
                        <attribute name="Property">(max)</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">OldUsage</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$PercentageOperation">
                        <attribute name="Description">Old領域の使用率[%]</attribute>
                        <attribute name="Key">OldUsedRate</attribute>
                        <attribute name="ContextKey">OldUsedRate</attribute>
                        <attribute name="Scale">2</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="ReturnZeroOnZeroDivide">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">OldUsed</attribute>
                            </object>
                        </attribute>
                        <attribute name="SecondTarget">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">OldMax</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="Description">YoungGCの回数</attribute>
                        <attribute name="ObjectName">java.lang:type=GarbageCollector,name=G1 Young Generation</attribute>
                        <attribute name="ContextKey">YoungGCCount</attribute>
                        <attribute name="Key">YoungGCCount</attribute>
                        <attribute name="Name">CollectionCount</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">YoungGCの回数の差分</attribute>
                        <attribute name="Key">YoungGCCountDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">YoungGCCount</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="Description">YoungGCの時間</attribute>
                        <attribute name="ObjectName">java.lang:type=GarbageCollector,name=G1 Young Generation</attribute>
                        <attribute name="ContextKey">YoungGCTime</attribute>
                        <attribute name="Key">YoungGCTime</attribute>
                        <attribute name="Name">CollectionTime</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">YoungGCの時間の差分</attribute>
                        <attribute name="Key">YoungGCTimeDelta</attribute>
                        <attribute name="ContextKey">YoungGCTimeDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">YoungGCTime</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="Description">FullGCの回数</attribute>
                        <attribute name="ObjectName">java.lang:type=GarbageCollector,name=G1 Old Generation</attribute>
                        <attribute name="ContextKey">FullGCCount</attribute>
                        <attribute name="Key">FullGCCount</attribute>
                        <attribute name="Name">CollectionCount</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">FullGCの回数の差分</attribute>
                        <attribute name="Key">FullGCCountDelta</attribute>
                        <attribute name="ContextKey">FullGCCountDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">FullGCCount</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attribute">
                        <attribute name="Description">FullGCの時間</attribute>
                        <attribute name="ObjectName">java.lang:type=GarbageCollector,name=G1 Old Generation</attribute>
                        <attribute name="ContextKey">FullGCTime</attribute>
                        <attribute name="Key">FullGCTime</attribute>
                        <attribute name="Name">CollectionTime</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">FullGCの時間の差分</attribute>
                        <attribute name="Key">FullGCTimeDelta</attribute>
                        <attribute name="ContextKey">FullGCTimeDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">FullGCTime</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
        </service>

        <service name="Java8G1HeapWritableRecordFactory"
                 template="Template.Service.Writer.WritableRecordFactory#PropertyWritableRecordFactory"
                 instance="template">
<ifdef name="Template.Service.JMX.MBeanWatcher.Java.COMPRESSED_CLASS_SPACE" value="true">
            <attribute name="Format">%Timestamp%,%CodeCacheUsed%,%CodeCacheMax%,%CodeCacheUsedRate%,%CompressedClassUsed%,%CompressedClassMax%,%CompressedClassUsedRate%,%MetaspaceUsed%,%MetaspaceMax%,%MetaspaceUsedRate%,%EdenUsed%,%EdenCommitted%,%EdenUsedRate%,%SurvivorUsed%,%SurvivorCommitted%,%SurvivorUsedRate%,%OldUsed%,%OldMax%,%OldUsedRate%,%YoungGCCount%,%YoungGCCountDelta%,%YoungGCTime%,%YoungGCTimeDelta%,%FullGCCount%,%FullGCCountDelta%,%FullGCTime%,%FullGCTimeDelta%</attribute>
</ifdef>
<ifdef name="Template.Service.JMX.MBeanWatcher.Java.COMPRESSED_CLASS_SPACE" value="true" not="true">
            <attribute name="Format">%Timestamp%,%CodeCacheUsed%,%CodeCacheMax%,%CodeCacheUsedRate%,%MetaspaceUsed%,%MetaspaceMax%,%MetaspaceUsedRate%,%EdenUsed%,%EdenCommitted%,%EdenUsedRate%,%SurvivorUsed%,%SurvivorCommitted%,%SurvivorUsedRate%,%OldUsed%,%OldMax%,%OldUsedRate%,%YoungGCCount%,%YoungGCCountDelta%,%YoungGCTime%,%YoungGCTimeDelta%,%FullGCCount%,%FullGCCountDelta%,%FullGCTime%,%FullGCTimeDelta%</attribute>
</ifdef>
        </service>
    </manager>

    <manager name="Template.Service.JMX.MBeanWatcher.System">

        <!-- jp.ossc.nimbus.service.system.OperationSystemを監視するサービス -->
        <service name="OperatingSystemWatcher"
                 template="Template.Service.JMX#MBeanWatcher"
                 instance="template">
            
            <attribute name="Description">OSのリソース監視</attribute>
            
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Timestamp">
                        <attribute name="Description">タイムスタンプ</attribute>
<ifdef name="Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT">
                        <attribute name="Format">${Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT}</attribute>
</ifdef>
                    </object>
                </argument>
            </invoke>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attributes">
                        <attribute name="ContextKey">Attributes</attribute>
                        <attribute name="Names">
                            ProcessCpuTime,
                            AvailableProcessors,
                            SystemLoadAverage,
                            FreePhysicalMemorySize,
                            TotalPhysicalMemorySize,
                            FreeSwapSpaceSize,
                            TotalSwapSpaceSize,
                            OpenFileDescriptorCount,
                            MaxFileDescriptorCount
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">CPU時間</attribute>
                        <attribute name="Key">ProcessCpuTime</attribute>
                        <attribute name="ContextKey">Attributes.ProcessCpuTime</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">CPU時間の差分</attribute>
                        <attribute name="Key">ProcessCpuTimeDelta</attribute>
                        <attribute name="ContextKey">ProcessCpuTimeDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes.ProcessCpuTime</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">利用可能なプロセッサ数</attribute>
                        <attribute name="Key">AvailableProcessors</attribute>
                        <attribute name="ContextKey">Attributes.AvailableProcessors</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">実行待ちプロセス数の平均値</attribute>
                        <attribute name="Key">SystemLoadAverage</attribute>
                        <attribute name="ContextKey">Attributes.SystemLoadAverage</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$PercentageOperation">
                        <attribute name="Description">CPU使用率[%]</attribute>
                        <attribute name="Key">CPUUsageRate</attribute>
                        <attribute name="ContextKey">CPUUsageRate</attribute>
                        <attribute name="Scale">2</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="ReturnZeroOnZeroDivide">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes.SystemLoadAverage</attribute>
                            </object>
                        </attribute>
                        <attribute name="SecondTarget">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes.AvailableProcessors</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">物理メモリ空き量</attribute>
                        <attribute name="Key">FreePhysicalMemorySize</attribute>
                        <attribute name="ContextKey">Attributes.FreePhysicalMemorySize</attribute>
                    </object>
                </argument>
            </invoke>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">物理メモリ最大量</attribute>
                        <attribute name="Key">TotalPhysicalMemorySize</attribute>
                        <attribute name="ContextKey">Attributes.TotalPhysicalMemorySize</attribute>
                    </object>
                </argument>
            </invoke>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$SubtractOperation">
                        <attribute name="Description">物理メモリ使用量</attribute>
                        <attribute name="Key">UsedPhysicalMemorySize</attribute>
                        <attribute name="ContextKey">UsedPhysicalMemorySize</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes.TotalPhysicalMemorySize</attribute>
                            </object>
                        </attribute>
                        <attribute name="SecondTarget">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes.FreePhysicalMemorySize</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$PercentageOperation">
                        <attribute name="Description">物理メモリ使用率[%]</attribute>
                        <attribute name="Key">UsedPhysicalMemorySizeRate</attribute>
                        <attribute name="ContextKey">UsedPhysicalMemorySizeRate</attribute>
                        <attribute name="Scale">2</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="ReturnZeroOnZeroDivide">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">UsedPhysicalMemorySize</attribute>
                            </object>
                        </attribute>
                        <attribute name="SecondTarget">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes.TotalPhysicalMemorySize</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">スワップ空き量</attribute>
                        <attribute name="Key">FreeSwapSpaceSize</attribute>
                        <attribute name="ContextKey">Attributes.FreeSwapSpaceSize</attribute>
                    </object>
                </argument>
            </invoke>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">スワップ最大量</attribute>
                        <attribute name="Key">TotalSwapSpaceSize</attribute>
                        <attribute name="ContextKey">Attributes.TotalSwapSpaceSize</attribute>
                    </object>
                </argument>
            </invoke>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$SubtractOperation">
                        <attribute name="Description">スワップ使用量</attribute>
                        <attribute name="Key">UsedSwapSpaceSize</attribute>
                        <attribute name="ContextKey">UsedSwapSpaceSize</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes.TotalSwapSpaceSize</attribute>
                            </object>
                        </attribute>
                        <attribute name="SecondTarget">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes.FreeSwapSpaceSize</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$PercentageOperation">
                        <attribute name="Description">スワップ使用率[%]</attribute>
                        <attribute name="Key">UsedSwapSpaceSizeRate</attribute>
                        <attribute name="ContextKey">UsedSwapSpaceSizeRate</attribute>
                        <attribute name="Scale">2</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="ReturnZeroOnZeroDivide">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes.UsedSwapSpaceSize</attribute>
                            </object>
                        </attribute>
                        <attribute name="SecondTarget">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes.TotalSwapSpaceSize</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">ファイルデスクリプタの使用数</attribute>
                        <attribute name="Key">OpenFileDescriptorCount</attribute>
                        <attribute name="ContextKey">Attributes.OpenFileDescriptorCount</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">ファイルデスクリプタの使用数の差分</attribute>
                        <attribute name="Key">OpenFileDescriptorCountDelta</attribute>
                        <attribute name="ContextKey">OpenFileDescriptorCountDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes.OpenFileDescriptorCount</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">ファイルデスクリプタの最大数</attribute>
                        <attribute name="Key">MaxFileDescriptorCount</attribute>
                        <attribute name="ContextKey">Attributes.MaxFileDescriptorCount</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$PercentageOperation">
                        <attribute name="Description">ファイルデスクリプタの使用率[%]</attribute>
                        <attribute name="Key">OpenFileDescriptorRate</attribute>
                        <attribute name="ContextKey">OpenFileDescriptorRate</attribute>
                        <attribute name="Scale">2</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="ReturnZeroOnZeroDivide">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes.OpenFileDescriptorCount</attribute>
                            </object>
                        </attribute>
                        <attribute name="SecondTarget">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes.MaxFileDescriptorCount</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
        </service>

        <service name="OperatingSystemWritableRecordFactory"
                 template="Template.Service.Writer.WritableRecordFactory#PropertyWritableRecordFactory"
                 instance="template">
            <attribute name="Format">%Timestamp%,%ProcessCpuTime%,%ProcessCpuTimeDelta%,%SystemLoadAverage%,%CPUUsageRate%,%UsedPhysicalMemorySize%,%TotalPhysicalMemorySize%,%UsedPhysicalMemorySizeRate%,%UsedSwapSpaceSize%,%TotalSwapSpaceSize%,%UsedSwapSpaceSizeRate%,%OpenFileDescriptorCount%,%MaxFileDescriptorCount%,%OpenFileDescriptorRate%</attribute>
        </service>
    </manager>

    <manager name="Template.Service.JMX.MBeanWatcher.Cache">

        <!-- jp.ossc.nimbus.service.cache.CacheMapを監視するサービス -->
        <service name="CacheMapWatcher"
                 template="Template.Service.JMX#MBeanWatcher"
                 instance="template">

            <service-property name="Template.Service.JMX.MBeanWatcher.Cache.MAX_SIZE_PERIOD_COUNT">60</service-property>
            
            <attribute name="Description">CacheMapの監視</attribute>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Timestamp">
                        <attribute name="Description">タイムスタンプ</attribute>
<ifdef name="Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT">
                        <attribute name="Format">${Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT}</attribute>
</ifdef>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Operation">
                        <attribute name="Description">キャッシュ数</attribute>
                        <attribute name="Key">Size</attribute>
                        <attribute name="ContextKey">Size</attribute>
                        <attribute name="Name">size</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">キャッシュ数の差分</attribute>
                        <attribute name="Key">SizeDelta</attribute>
                        <attribute name="ContextKey">SizeDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Size</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Max">
                        <attribute name="Description">期間内のキャッシュ数の最大</attribute>
                        <attribute name="Key">MaxSize</attribute>
                        <attribute name="ContextKey">MaxSize</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Period">
                                <attribute name="Interval">${Template.Service.JMX.MBeanWatcher.CHECK_INTERVAL}</attribute>
                                <attribute name="Count">${Template.Service.JMX.MBeanWatcher.Queue.MAX_SIZE_PERIOD_COUNT}</attribute>
                                <attribute name="Target">
                                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                        <attribute name="ContextKey">Size</attribute>
                                    </object>
                                </attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
        </service>

        <service name="CacheMapWritableRecordFactory"
                 template="Template.Service.Writer.WritableRecordFactory#PropertyWritableRecordFactory"
                 instance="template">
            <attribute name="Format">%Timestamp%,%Size%,%SizeDelta%,%MaxSize%</attribute>
        </service>
    </manager>

    <manager name="Template.Service.JMX.MBeanWatcher.KeepAlive">

        <!-- jp.ossc.nimbus.service.keepalive.ClusterServiceMBeanを監視するサービス -->
        <service name="ClusterWatcher"
                 template="Template.Service.JMX#MBeanWatcher"
                 instance="template">
            
            <attribute name="Description">Clusterの監視</attribute>
            
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Timestamp">
                        <attribute name="Description">タイムスタンプ</attribute>
<ifdef name="Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT">
                        <attribute name="Format">${Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT}</attribute>
</ifdef>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attributes">
                        <attribute name="ContextKey">Attributes</attribute>
                        <attribute name="Names">
                            Main,
                            Join,
                            Client,
                            Members,
                            ClientMembers
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">稼働系フラグ（true：稼働系、false:待機系）</attribute>
                        <attribute name="Key">Main</attribute>
                        <attribute name="ContextKey">Attributes.Main</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">参加フラグ（true：参加、false:不参加）</attribute>
                        <attribute name="Key">Join</attribute>
                        <attribute name="ContextKey">Attributes.Join</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">クライアントフラグ（true：クライアントモード、false:サーバモード）</attribute>
                        <attribute name="Key">Client</attribute>
                        <attribute name="ContextKey">Attributes.Client</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">参加メンバ</attribute>
                        <attribute name="Key">Members</attribute>
                        <attribute name="ContextKey">Members</attribute>
                        <attribute name="Property">Members</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">参加メンバ数</attribute>
                        <attribute name="Key">MemberSize</attribute>
                        <attribute name="ContextKey">MemberSize</attribute>
                        <attribute name="Property">size</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Members</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">参加メンバ数の差分</attribute>
                        <attribute name="Key">MemberSizeDelta</attribute>
                        <attribute name="ContextKey">MemberSizeDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">MemberSize</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">クライアントメンバ</attribute>
                        <attribute name="Key">ClientMembers</attribute>
                        <attribute name="ContextKey">ClientMembers</attribute>
                        <attribute name="Property">ClientMembers</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">クライアントメンバ数</attribute>
                        <attribute name="Key">ClientMemberSize</attribute>
                        <attribute name="ContextKey">ClientMemberSize</attribute>
                        <attribute name="Property">size</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">ClientMembers</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">クライアントメンバ数の差分</attribute>
                        <attribute name="Key">ClientMemberSizeDelta</attribute>
                        <attribute name="ContextKey">ClientMemberSizeDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">ClientMemberSize</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
        </service>

        <service name="ClusterWritableRecordFactory"
                 template="Template.Service.Writer.WritableRecordFactory#PropertyWritableRecordFactory"
                 instance="template">
            <attribute name="Format">%Timestamp%,%Main%,%Join%,%Client%,%Members%,%MemberSize%,%MemberSizeDelta%,%ClientMembers%,%ClientMemberSize%,%ClientMemberSizeDelta%</attribute>
        </service>
    </manager>

    <manager name="Template.Service.JMX.MBeanWatcher.Context">

        <!-- jp.ossc.nimbus.service.context.SharedContextServiceMBeanを監視するサービス -->
        <service name="SharedContextWatcher"
                 template="Template.Service.JMX#MBeanWatcher"
                 instance="template">

            <service-property name="Template.Service.JMX.MBeanWatcher.Context.MAX_SIZE_PERIOD_COUNT">60</service-property>
            
            <attribute name="Description">SharedContextの監視</attribute>

            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Timestamp">
                        <attribute name="Description">タイムスタンプ</attribute>
<ifdef name="Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT">
                        <attribute name="Format">${Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT}</attribute>
</ifdef>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Operation">
                        <attribute name="Description">ローカルのデータ数</attribute>
                        <attribute name="Key">SizeLocal</attribute>
                        <attribute name="ContextKey">SizeLocal</attribute>
                        <attribute name="Name">sizeLocal</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">ローカルのデータ数の差分</attribute>
                        <attribute name="Key">SizeLocalDelta</attribute>
                        <attribute name="ContextKey">SizeLocalDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">SizeLocal</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Max">
                        <attribute name="Description">期間内のローカルのデータ数の最大</attribute>
                        <attribute name="Key">MaxSizeLocal</attribute>
                        <attribute name="ContextKey">MaxSizeLocal</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Period">
                                <attribute name="Interval">${Template.Service.JMX.MBeanWatcher.CHECK_INTERVAL}</attribute>
                                <attribute name="Count">${Template.Service.JMX.MBeanWatcher.Context.MAX_SIZE_PERIOD_COUNT}</attribute>
                                <attribute name="Target">
                                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                        <attribute name="ContextKey">SizeLocal</attribute>
                                    </object>
                                </attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attributes">
                        <attribute name="ContextKey">Attributes</attribute>
                        <attribute name="Names">
                            CacheHitRatio,
                            Main
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">キャッシュヒット率[%]</attribute>
                        <attribute name="Key">CacheHitRatio</attribute>
                        <attribute name="ContextKey">Attributes.CacheHitRatio</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">主ノードフラグ（true：主ノード、false:バックアップノード）</attribute>
                        <attribute name="Key">Main</attribute>
                        <attribute name="ContextKey">Attributes.Main</attribute>
                    </object>
                </argument>
            </invoke>
        </service>

        <service name="SharedContextWritableRecordFactory"
                 template="Template.Service.Writer.WritableRecordFactory#PropertyWritableRecordFactory"
                 instance="template">
            <attribute name="Format">%Timestamp%,%SizeLocal%,%SizeLocalDelta%,%MaxSizeLocal%,%CacheHitRatio%,%Main%</attribute>
        </service>

        <!-- jp.ossc.nimbus.service.context.DistributedSharedContextServiceMBeanを監視するサービス -->
        <service name="DistributedSharedContextWatcher"
                 template="Template.Service.JMX#MBeanWatcher"
                 instance="template">
            
            <attribute name="Description">DistributedSharedContextの監視</attribute>
            
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Timestamp">
                        <attribute name="Description">タイムスタンプ</attribute>
<ifdef name="Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT">
                        <attribute name="Format">${Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT}</attribute>
</ifdef>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Operation">
                        <attribute name="Description">ローカルのデータ数</attribute>
                        <attribute name="Key">SizeLocal</attribute>
                        <attribute name="ContextKey">SizeLocal</attribute>
                        <attribute name="Name">sizeLocal</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">ローカルのデータ数の差分</attribute>
                        <attribute name="Key">SizeLocalDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">SizeLocal</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Max">
                        <attribute name="Description">期間内のローカルのデータ数の最大</attribute>
                        <attribute name="Key">MaxSizeLocal</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Period">
                                <attribute name="Interval">${Template.Service.JMX.MBeanWatcher.CHECK_INTERVAL}</attribute>
                                <attribute name="Count">${Template.Service.JMX.MBeanWatcher.Context.MAX_SIZE_PERIOD_COUNT}</attribute>
                                <attribute name="Target">
                                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                        <attribute name="ContextKey">SizeLocal</attribute>
                                    </object>
                                </attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attributes">
                        <attribute name="ContextKey">Attributes</attribute>
                        <attribute name="Names">
                            CacheHitRatio,
                            Main,
                            MainNodeCount
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">キャッシュヒット率[%]</attribute>
                        <attribute name="Key">CacheHitRatio</attribute>
                        <attribute name="ContextKey">Attributes.CacheHitRatio</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">主ノードフラグ（true：主ノード、false:バックアップノード）</attribute>
                        <attribute name="Key">Main</attribute>
                        <attribute name="ContextKey">Attributes.Main</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">主ノード数</attribute>
                        <attribute name="Key">MainNodeCount</attribute>
                        <attribute name="ContextKey">Attributes.MainNodeCount</attribute>
                    </object>
                </argument>
            </invoke>
        </service>

        <service name="DistributedSharedContextWritableRecordFactory"
                 template="Template.Service.Writer.WritableRecordFactory#PropertyWritableRecordFactory"
                 instance="template">
            <attribute name="Format">%Timestamp%,%SizeLocal%,%SizeLocalDelta%,%MaxSizeLocal%,%CacheHitRatio%,%Main%,%MainNodeCount%</attribute>
        </service>
    </manager>

    <manager name="Template.Service.JMX.MBeanWatcher.Publish">

        <!-- jp.ossc.nimbus.service.publish.udp.ClientConnectionImpl.ClientConnectionServiceMBeanの集合を監視するサービス -->
        <service name="UDPClientConnectionsWatcher"
                 template="Template.Service.JMX#MBeanWatcher"
                 instance="template">
            
            <attribute name="Description">ClientConnection（UDP通信）の集合の監視</attribute>
            
            <attribute name="MBeanSet">true</attribute>
            
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Timestamp">
                        <attribute name="Description">タイムスタンプ</attribute>
<ifdef name="Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT">
                        <attribute name="Format">${Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT}</attribute>
</ifdef>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attributes">
                        <attribute name="ContextKey">Attributes</attribute>
                        <attribute name="Names">
                            ReceivePacketCount,
                            ReceivePacketQueueDepth,
                            ReceivePacketQueueMaxDepth,
                            ReceiveCount,
                            LostCount,
                            MissingWindowRequestCount,
                            NoContinuousMessageCount,
                            WasteWindowCount
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Sum">
                        <attribute name="Description">受信パケット数</attribute>
                        <attribute name="Key">ReceivePacketCount</attribute>
                        <attribute name="ContextKey">ReceivePacketCount</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                                <attribute name="Property">ReceivePacketCount</attribute>
                                <attribute name="Target">
                                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                        <attribute name="ContextKey">Attributes</attribute>
                                    </object>
                                </attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">受信パケット数の差分</attribute>
                        <attribute name="Key">ReceivePacketCountDelta</attribute>
                        <attribute name="ContextKey">ReceivePacketCountDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">ReceivePacketCount</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Sum">
                        <attribute name="Description">受信パケットの受付キューの滞留数</attribute>
                        <attribute name="Key">ReceivePacketQueueDepth</attribute>
                        <attribute name="ContextKey">ReceivePacketQueueDepth</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                                <attribute name="ElementEdit">true</attribute>
                                <attribute name="Property">ReceivePacketQueueDepth</attribute>
                                <attribute name="Target">
                                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                        <attribute name="ContextKey">Attributes</attribute>
                                    </object>
                                </attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">受信パケットの受付キューの滞留数の差分</attribute>
                        <attribute name="Key">ReceivePacketQueueDepthDelta</attribute>
                        <attribute name="ContextKey">ReceivePacketQueueDepthDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">ReceivePacketQueueDepth</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Sum">
                        <attribute name="Description">受信パケットの受付キューの滞留数の最大</attribute>
                        <attribute name="Key">ReceivePacketQueueMaxDepth</attribute>
                        <attribute name="ContextKey">ReceivePacketQueueMaxDepth</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                                <attribute name="ElementEdit">true</attribute>
                                <attribute name="Property">ReceivePacketQueueMaxDepth</attribute>
                                <attribute name="Target">
                                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                        <attribute name="ContextKey">Attributes</attribute>
                                    </object>
                                </attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Sum">
                        <attribute name="Description">受信メッセージ数</attribute>
                        <attribute name="Key">ReceiveCount</attribute>
                        <attribute name="ContextKey">ReceiveCount</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                                <attribute name="ElementEdit">true</attribute>
                                <attribute name="Property">ReceiveCount</attribute>
                                <attribute name="Target">
                                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                        <attribute name="ContextKey">Attributes</attribute>
                                    </object>
                                </attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">受信メッセージ数の差分</attribute>
                        <attribute name="Key">ReceiveCountDelta</attribute>
                        <attribute name="ContextKey">ReceiveCountDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">ReceiveCount</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Sum">
                        <attribute name="Description">欠損メッセージ数</attribute>
                        <attribute name="Key">LostCount</attribute>
                        <attribute name="ContextKey">LostCount</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                                <attribute name="ElementEdit">true</attribute>
                                <attribute name="Property">LostCount</attribute>
                                <attribute name="Target">
                                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                        <attribute name="ContextKey">Attributes</attribute>
                                    </object>
                                </attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">欠損メッセージ数の差分</attribute>
                        <attribute name="Key">LostCountDelta</attribute>
                        <attribute name="ContextKey">LostCountDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">LostCount</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Sum">
                        <attribute name="Description">未到達ウィンドウの再送要求回数</attribute>
                        <attribute name="Key">MissingWindowRequestCount</attribute>
                        <attribute name="ContextKey">MissingWindowRequestCount</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                                <attribute name="ElementEdit">true</attribute>
                                <attribute name="Property">MissingWindowRequestCount</attribute>
                                <attribute name="Target">
                                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                        <attribute name="ContextKey">Attributes</attribute>
                                    </object>
                                </attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">未到達ウィンドウの再送要求回数の差分</attribute>
                        <attribute name="Key">MissingWindowRequestCountDelta</attribute>
                        <attribute name="ContextKey">MissingWindowRequestCountDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">MissingWindowRequestCount</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Sum">
                        <attribute name="Description">不連続メッセージ数</attribute>
                        <attribute name="Key">NoContinuousMessageCount</attribute>
                        <attribute name="ContextKey">NoContinuousMessageCount</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                                <attribute name="ElementEdit">true</attribute>
                                <attribute name="Property">NoContinuousMessageCount</attribute>
                                <attribute name="Target">
                                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                        <attribute name="ContextKey">Attributes</attribute>
                                    </object>
                                </attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">不連続メッセージ数の差分</attribute>
                        <attribute name="Key">NoContinuousMessageCountDelta</attribute>
                        <attribute name="ContextKey">NoContinuousMessageCountDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">NoContinuousMessageCount</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Sum">
                        <attribute name="Description">重複メッセージ数</attribute>
                        <attribute name="Key">WasteWindowCount</attribute>
                        <attribute name="ContextKey">WasteWindowCount</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                                <attribute name="ElementEdit">true</attribute>
                                <attribute name="Property">WasteWindowCount</attribute>
                                <attribute name="Target">
                                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                        <attribute name="ContextKey">Attributes</attribute>
                                    </object>
                                </attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">重複メッセージ数の差分</attribute>
                        <attribute name="Key">WasteWindowCountDelta</attribute>
                        <attribute name="ContextKey">WasteWindowCountDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">WasteWindowCount</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
        </service>

        <service name="UDPClientConnectionWritableRecordFactory"
                 template="Template.Service.Writer.WritableRecordFactory#PropertyWritableRecordFactory"
                 instance="template">
            <attribute name="Format">%Timestamp%,%ReceivePacketCount%,%ReceivePacketCountDelta%,%ReceivePacketQueueDepth%,%ReceivePacketQueueDepthDelta%,%ReceivePacketQueueMaxDepth%,%ReceiveCount%,%ReceiveCountDelta%,%LostCount%,%LostCountDelta%,%MissingWindowRequestCount%,%MissingWindowRequestCountDelta%,%NoContinuousMessageCount%,%NoContinuousMessageCountDelta%,%WasteWindowCount%,%WasteWindowCountDelta%</attribute>
        </service>

        <!-- jp.ossc.nimbus.service.publish.tcp.ClientConnectionImpl.ClientConnectionServiceMBeanの集合を監視するサービス -->
        <service name="TCPClientConnectionsWatcher"
                 template="Template.Service.JMX#MBeanWatcher"
                 instance="template">
            
            <attribute name="Description">ClientConnection（TCP通信）の集合の監視</attribute>
            
            <attribute name="MBeanSet">true</attribute>
            
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Timestamp">
                        <attribute name="Description">タイムスタンプ</attribute>
<ifdef name="Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT">
                        <attribute name="Format">${Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT}</attribute>
</ifdef>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attributes">
                        <attribute name="ContextKey">Attributes</attribute>
                        <attribute name="Names">
                            ReceiveCount,
                            RemoteSocketAddress
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Sum">
                        <attribute name="Description">受信メッセージ数</attribute>
                        <attribute name="Key">ReceiveCount</attribute>
                        <attribute name="ContextKey">ReceiveCount</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                                <attribute name="ElementEdit">true</attribute>
                                <attribute name="Property">ReceiveCount</attribute>
                                <attribute name="Target">
                                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                        <attribute name="ContextKey">Attributes</attribute>
                                    </object>
                                </attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">受信メッセージ数の差分</attribute>
                        <attribute name="Key">ReceiveCountDelta</attribute>
                        <attribute name="ContextKey">ReceiveCountDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">ReceiveCount</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">送信元アドレス</attribute>
                        <attribute name="Key">RemoteSocketAddress</attribute>
                        <attribute name="ContextKey">RemoteSocketAddress</attribute>
                        <attribute name="Property">RemoteSocketAddress</attribute>
                        <attribute name="ElementEdit">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Property">
                        <attribute name="Description">送信元サーバ数</attribute>
                        <attribute name="Key">ServerSize</attribute>
                        <attribute name="ContextKey">ServerSize</attribute>
                        <attribute name="Property">size</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">RemoteSocketAddress</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">送信元サーバ数の差分</attribute>
                        <attribute name="Key">ServerSizeDelta</attribute>
                        <attribute name="ContextKey">ServerSizeDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">ServerSize</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
        </service>

        <service name="TCPClientConnectionWritableRecordFactory"
                 template="Template.Service.Writer.WritableRecordFactory#PropertyWritableRecordFactory"
                 instance="template">
            <attribute name="Format">%Timestamp%,%ReceiveCount%,%ReceiveCountDelta%,%ServerSize%,%ServerSizeDelta%,"%RemoteSocketAddress%"</attribute>
        </service>

        <!-- jp.ossc.nimbus.service.publish.udp.ConnectionFactoryServiceMBeanを監視するサービス -->
        <service name="UDPServerConnectionWatcher"
                 template="Template.Service.JMX#MBeanWatcher"
                 instance="template">
            
            <attribute name="Description">ServerConnection（UDP通信）の監視</attribute>
            
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Timestamp">
                        <attribute name="Description">タイムスタンプ</attribute>
<ifdef name="Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT">
                        <attribute name="Format">${Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT}</attribute>
</ifdef>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attributes">
                        <attribute name="ContextKey">Attributes</attribute>
                        <attribute name="Names">
                            SendCount,
                            SendPacketCount,
                            AverageWindowCount,
                            MaxWindowCount,
                            ClientSize,
                            Clients,
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">送信メッセージ数</attribute>
                        <attribute name="Key">SendCount</attribute>
                        <attribute name="ContextKey">Attributes.SendCount</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">送信メッセージ数の差分</attribute>
                        <attribute name="Key">SendCountDelta</attribute>
                        <attribute name="ContextKey">SendCountDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes.SendCount</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">送信パケット数</attribute>
                        <attribute name="Key">SendPacketCount</attribute>
                        <attribute name="ContextKey">Attributes.SendPacketCount</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">送信パケット数の差分</attribute>
                        <attribute name="Key">SendPacketCountDelta</attribute>
                        <attribute name="ContextKey">SendPacketCountDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes.SendPacketCount</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">ウィンドウ数の平均</attribute>
                        <attribute name="Key">AverageWindowCount</attribute>
                        <attribute name="ContextKey">Attributes.AverageWindowCount</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">ウィンドウ数の最大</attribute>
                        <attribute name="Key">MaxWindowCount</attribute>
                        <attribute name="ContextKey">Attributes.MaxWindowCount</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">送信先のクライアント数</attribute>
                        <attribute name="Key">ClientSize</attribute>
                        <attribute name="ContextKey">Attributes.ClientSize</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">送信先のクライアント</attribute>
                        <attribute name="Key">Clients</attribute>
                        <attribute name="ContextKey">Attributes.Clients</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$ChangeSet">
                        <attribute name="Description">切断された送信先のクライアント</attribute>
                        <attribute name="Key">DecreaseClient</attribute>
                        <attribute name="ContextKey">DecreaseClient</attribute>
                        <attribute name="ChangeAdd">false</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes.Clients</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
        </service>

        <service name="UDPServerConnectionWritableRecordFactory"
                 template="Template.Service.Writer.WritableRecordFactory#PropertyWritableRecordFactory"
                 instance="template">
            <attribute name="Format">%Timestamp%,%SendCount%,%SendCountDelta%,%SendPacketCount%,%SendPacketCountDelta%,%AverageWindowCount%,%MaxWindowCount%,%ClientSize%,"%Clients%","%DecreaseClient%"</attribute>
        </service>

        <!-- jp.ossc.nimbus.service.publish.tcp.ConnectionFactoryServiceMBeanを監視するサービス -->
        <service name="TCPServerConnectionWatcher"
                 template="Template.Service.JMX#MBeanWatcher"
                 instance="template">
            
            <attribute name="Description">ServerConnection（TCP通信）の監視</attribute>
            
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Timestamp">
                        <attribute name="Description">タイムスタンプ</attribute>
<ifdef name="Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT">
                        <attribute name="Format">${Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT}</attribute>
</ifdef>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attributes">
                        <attribute name="ContextKey">Attributes</attribute>
                        <attribute name="Names">
                            SendCount,
                            ClientSize,
                            Clients,
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">送信メッセージ数</attribute>
                        <attribute name="Key">SendCount</attribute>
                        <attribute name="ContextKey">Attributes.SendCount</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Change">
                        <attribute name="Description">送信メッセージ数の差分</attribute>
                        <attribute name="Key">SendCountDelta</attribute>
                        <attribute name="ContextKey">SendCountDelta</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes.SendCount</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">送信先のクライアント数</attribute>
                        <attribute name="Key">ClientSize</attribute>
                        <attribute name="ContextKey">Attributes.ClientSize</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">送信先のクライアント</attribute>
                        <attribute name="Key">Clients</attribute>
                        <attribute name="ContextKey">Attributes.Clients</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$ChangeSet">
                        <attribute name="Description">切断された送信先のクライアント</attribute>
                        <attribute name="Key">DecreaseClient</attribute>
                        <attribute name="ContextKey">DecreaseClient</attribute>
                        <attribute name="ChangeAdd">false</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes.Clients</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
        </service>

        <service name="TCPServerConnectionWritableRecordFactory"
                 template="Template.Service.Writer.WritableRecordFactory#PropertyWritableRecordFactory"
                 instance="template">
            <attribute name="Format">%Timestamp%,%SendCount%,%SendCountDelta%,%ClientSize%,"%Clients%","%DecreaseClient%"</attribute>
        </service>
    </manager>

    <manager name="Template.Service.JMX.MBeanWatcher.Connection">

        <!-- jp.ossc.nimbus.service.connection.DefaultQuerySearchManagerServiceMBeanを監視するサービス -->
        <service name="QuerySearchWatcher"
                 template="Template.Service.JMX#MBeanWatcher"
                 instance="template">
            
            <attribute name="Description">QuerySearchManagerの監視</attribute>
            
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Timestamp">
                        <attribute name="Description">タイムスタンプ</attribute>
<ifdef name="Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT">
                        <attribute name="Format">${Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT}</attribute>
</ifdef>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attributes">
                        <attribute name="ContextKey">Attributes</attribute>
                        <attribute name="Names">
                            CacheHitRatio
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">キャッシュヒット率[%]</attribute>
                        <attribute name="Key">CacheHitRatio</attribute>
                        <attribute name="ContextKey">Attributes.CacheHitRatio</attribute>
                    </object>
                </argument>
            </invoke>
        </service>

        <service name="QuerySearchWritableRecordFactory"
                 code="jp.ossc.nimbus.service.writer.PropertyWritableRecordFactoryService">
            <attribute name="Format">%Timestamp%,%CacheHitRatio%</attribute>
        </service>
    </manager>

    <manager name="Template.Service.JMX.MBeanWatcher.Semaphore">

        <!-- jp.ossc.nimbus.service.semaphore.DefaultSemaphoreServiceMBeanを監視するサービス -->
        <service name="SemaphoreWatcher"
                 template="Template.Service.JMX#MBeanWatcher"
                 instance="template">
            
            <attribute name="Description">Semaphoreの監視</attribute>
            
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Timestamp">
                        <attribute name="Description">タイムスタンプ</attribute>
<ifdef name="Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT">
                        <attribute name="Format">${Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT}</attribute>
</ifdef>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attributes">
                        <attribute name="ContextKey">Attributes</attribute>
                        <attribute name="Names">
                            ResourceRemain,
                            WaitingCount,
                            MaxUsedResource,
                            MaxWaitedCount
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">リソースの空き数</attribute>
                        <attribute name="Key">ResourceRemain</attribute>
                        <attribute name="ContextKey">Attributes.ResourceRemain</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">リソースの獲得待ち数</attribute>
                        <attribute name="Key">WaitingCount</attribute>
                        <attribute name="ContextKey">Attributes.WaitingCount</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">リソースの最大数</attribute>
                        <attribute name="Key">MaxUsedResource</attribute>
                        <attribute name="ContextKey">Attributes.MaxUsedResource</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">リソースの獲得待ち数の最大</attribute>
                        <attribute name="Key">MaxWaitedCount</attribute>
                        <attribute name="ContextKey">Attributes.MaxWaitedCount</attribute>
                    </object>
                </argument>
            </invoke>
        </service>

        <service name="SemaphoreWritableRecordFactory"
                 template="Template.Service.Writer.WritableRecordFactory#PropertyWritableRecordFactory"
                 instance="template">
            <attribute name="Format">%Timestamp%,%ResourceRemain%,%WaitingCount%,%MaxUsedResource%,%MaxWaitedCount%</attribute>
        </service>
    </manager>

    <manager name="Template.Service.JMX.MBeanWatcher.AOP">

        <!-- jp.ossc.nimbus.service.aop.interceptor.RequestProcessCheckInterceptorServiceMBeanを監視するサービス -->
        <service name="RequestProcessCheckInterceptorWatcher"
                 template="Template.Service.JMX#MBeanWatcher"
                 instance="template">
            
            <attribute name="Description">RequestProcessCheckInterceptorの監視</attribute>
            
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Timestamp">
                        <attribute name="Description">タイムスタンプ</attribute>
<ifdef name="Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT">
                        <attribute name="Format">${Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT}</attribute>
</ifdef>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attributes">
                        <attribute name="ContextKey">Attributes</attribute>
                        <attribute name="Names">
                            RequestCount
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">処理中のリクエスト数</attribute>
                        <attribute name="Key">RequestCount</attribute>
                        <attribute name="ContextKey">Attributes.RequestCount</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Max">
                        <attribute name="Description">期間内の処理中のリクエスト数の最大</attribute>
                        <attribute name="Key">MaxRequestCount</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Period">
                                <attribute name="Interval">${jmx.check.watcher.interval}</attribute>
                                <attribute name="Count">${jmx.check.watcher.count}</attribute>
                                <attribute name="Target">
                                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                        <attribute name="ContextKey">Attributes.RequestCount</attribute>
                                    </object>
                                </attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
        </service>

        <service name="RequestProcessCheckInterceptorWritableRecordFactory"
                 template="Template.Service.Writer.WritableRecordFactory#PropertyWritableRecordFactory"
                 instance="template">
            <attribute name="Format">%Timestamp%,%RequestCount%,%MaxRequestCount%</attribute>
        </service>
    </manager>

    <manager name="Template.Service.JMX.MBeanWatcher.Scheduler2">

        <!-- jp.ossc.nimbus.service.scheduler2.DefaultSchedulerServiceMBeanを監視するサービス -->
        <service name="SchedulerWatcher"
                 template="Template.Service.JMX#MBeanWatcher"
                 instance="template">
            
            <attribute name="Description">Schedulerの監視</attribute>
            
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Timestamp">
                        <attribute name="Description">タイムスタンプ</attribute>
<ifdef name="Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT">
                        <attribute name="Format">${Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT}</attribute>
</ifdef>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attributes">
                        <attribute name="ContextKey">Attributes</attribute>
                        <attribute name="Names">
                            ActiveScheduleDispatcherSize,
                            ScheduleDispatcherSize,
                            StateString,
                            StartEntry
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">実行中のスケジュール数</attribute>
                        <attribute name="Key">ActiveScheduleDispatcherSize</attribute>
                        <attribute name="ContextKey">Attributes.ActiveScheduleDispatcherSize</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">同時に実行可能なスケジュール数</attribute>
                        <attribute name="Key">ScheduleDispatcherSize</attribute>
                        <attribute name="ContextKey">Attributes.ScheduleDispatcherSize</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$SubtractOperation">
                        <attribute name="Description">同時に実行可能なスケジュール数の空き</attribute>
                        <attribute name="Key">RemainScheduleDispatcherSize</attribute>
                        <attribute name="ContextKey">RemainScheduleDispatcherSize</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes.ScheduleDispatcherSize</attribute>
                            </object>
                        </attribute>
                        <attribute name="SecondTarget">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes.ActiveScheduleDispatcherSize</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">サービスの状態</attribute>
                        <attribute name="Key">State</attribute>
                        <attribute name="ContextKey">Attributes.StateString</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">スケジュールの実行開始フラグ（true：開始、false:停止）</attribute>
                        <attribute name="Key">StartEntry</attribute>
                        <attribute name="ContextKey">Attributes.StartEntry</attribute>
                    </object>
                </argument>
            </invoke>
        </service>

        <service name="SchedulerWritableRecordFactory"
                 template="Template.Service.Writer.WritableRecordFactory#PropertyWritableRecordFactory"
                 instance="template">
            <attribute name="Format">%Timestamp%,%ActiveScheduleDispatcherSize%,%RemainScheduleDispatcherSize%,%State%,%StartEntry%</attribute>
        </service>
    </manager>

    <manager name="Template.Service.JMX.MBeanWatcher.JBoss5">

        <!-- org.jboss.web.tomcat.service.management.ThreadPoolを監視するサービス -->
        <service name="ThreadPoolWatcher"
                 template="Template.Service.JMX#MBeanWatcher"
                 instance="template">
            
            <attribute name="Description">JBossのスレッドプールの監視</attribute>
            
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Timestamp">
                        <attribute name="Description">タイムスタンプ</attribute>
<ifdef name="Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT">
                        <attribute name="Format">${Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT}</attribute>
</ifdef>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attributes">
                        <attribute name="ContextKey">Attributes</attribute>
                        <attribute name="Names">
                            currentThreadsBusy,
                            currentThreadCount,
                            maxThreads
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">実行中スレッドの数</attribute>
                        <attribute name="Key">CurrentThreadsBusy</attribute>
                        <attribute name="ContextKey">Attributes.currentThreadsBusy</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">スレッドプールの数</attribute>
                        <attribute name="Key">CurrentThreadCount</attribute>
                        <attribute name="ContextKey">Attributes.currentThreadCount</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">スレッドプールの数の最大</attribute>
                        <attribute name="Key">MaxThreads</attribute>
                        <attribute name="ContextKey">Attributes.maxThreads</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$SubtractOperation">
                        <attribute name="Description">スレッドプールの空き</attribute>
                        <attribute name="Key">RemainThreadCount</attribute>
                        <attribute name="ContextKey">RemainThreadCount</attribute>
                        <attribute name="NullToZero">true</attribute>
                        <attribute name="Target">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes.maxThreads</attribute>
                            </object>
                        </attribute>
                        <attribute name="SecondTarget">
                            <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                                <attribute name="ContextKey">Attributes.currentThreadsBusy</attribute>
                            </object>
                        </attribute>
                    </object>
                </argument>
            </invoke>
        </service>

        <service name="ThreadPoolWritableRecordFactory"
                 template="Template.Service.Writer.WritableRecordFactory#PropertyWritableRecordFactory"
                 instance="template">
            <attribute name="Format">%Timestamp%,%CurrentThreadsBusy%,%CurrentThreadCount%,%RemainThreadCount%,%MaxThreads%</attribute>
        </service>

        <!-- org.apache.catalina.Managerを監視するサービス -->
        <service name="WebApplicationWatcher"
                 template="Template.Service.JMX#MBeanWatcher"
                 instance="template">
            
            <attribute name="Description">JBossのWebアプリケーションの監視</attribute>
            
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Timestamp">
                        <attribute name="Description">タイムスタンプ</attribute>
<ifdef name="Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT">
                        <attribute name="Format">${Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT}</attribute>
</ifdef>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attributes">
                        <attribute name="ContextKey">Attributes</attribute>
                        <attribute name="Names">
                            activeSessions,
                            expiredSessions,
                            maxActive,
                            sessionAverageAliveTime,
                            sessionMaxAliveTime
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">有効なセッション数</attribute>
                        <attribute name="Key">ActiveSessions</attribute>
                        <attribute name="ContextKey">Attributes.activeSessions</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">破棄されたセッション数</attribute>
                        <attribute name="Key">ExpiredSessions</attribute>
                        <attribute name="ContextKey">Attributes.expiredSessions</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">有効なセッション数の最大</attribute>
                        <attribute name="Key">MaxActive</attribute>
                        <attribute name="ContextKey">Attributes.maxActive</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">セッションの生存時間の平均</attribute>
                        <attribute name="Key">SessionAverageAliveTime</attribute>
                        <attribute name="ContextKey">Attributes.sessionAverageAliveTime</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">セッションの生存時間の最大</attribute>
                        <attribute name="Key">SessionMaxAliveTime</attribute>
                        <attribute name="ContextKey">Attributes.sessionMaxAliveTime</attribute>
                    </object>
                </argument>
            </invoke>
        </service>

        <service name="WebApplicationWritableRecordFactory"
                 template="Template.Service.Writer.WritableRecordFactory#PropertyWritableRecordFactory"
                 instance="template">
            <attribute name="Format">%Timestamp%,%ActiveSessions%,%ExpiredSessions%,%MaxActive%,%SessionAverageAliveTime%,%SessionMaxAliveTime%</attribute>
        </service>

        <!-- org.jboss.resource.connectionmanager.JBossManagedConnectionPoolMBeanを監視するサービス -->
        <service name="ConnectionPoolWatcher"
                 template="Template.Service.JMX#MBeanWatcher"
                 instance="template">
            
            <attribute name="Description">JBossのデータソース接続プールの監視</attribute>
            
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Timestamp">
                        <attribute name="Description">タイムスタンプ</attribute>
<ifdef name="Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT">
                        <attribute name="Format">${Template.Service.JMX.MBeanWatcher.TIMESTAMP_FORMAT}</attribute>
</ifdef>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Attributes">
                        <attribute name="ContextKey">Attributes</attribute>
                        <attribute name="Names">
                            ConnectionCount,
                            AvailableConnectionCount,
                            InUseConnectionCount,
                            MaxConnectionsInUseCount
                        </attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">接続プール数の最大</attribute>
                        <attribute name="Key">ConnectionCount</attribute>
                        <attribute name="ContextKey">Attributes.ConnectionCount</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">使用可能な接続数</attribute>
                        <attribute name="Key">AvailableConnectionCount</attribute>
                        <attribute name="ContextKey">Attributes.AvailableConnectionCount</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">使用中の接続数</attribute>
                        <attribute name="Key">InUseConnectionCount</attribute>
                        <attribute name="ContextKey">Attributes.InUseConnectionCount</attribute>
                    </object>
                </argument>
            </invoke>
            <invoke name="addTarget">
                <argument type="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Target">
                    <object code="jp.ossc.nimbus.service.jmx.MBeanWatcherService$Context">
                        <attribute name="Description">使用中の接続数の最大</attribute>
                        <attribute name="Key">MaxConnectionsInUseCount</attribute>
                        <attribute name="ContextKey">Attributes.MaxConnectionsInUseCount</attribute>
                    </object>
                </argument>
            </invoke>
        </service>

        <service name="ConnectionPoolWritableRecordFactory"
                 template="Template.Service.Writer.WritableRecordFactory#PropertyWritableRecordFactory"
                 instance="template">
            <attribute name="Format">%Timestamp%,%ConnectionCount%,%AvailableConnectionCount%,%InUseConnectionCount%,%MaxConnectionsInUseCount%</attribute>
        </service>
    </manager>
</server>